#summary Server installation guide.
#labels Doc-Userguide

= Introduction =

This is a very rough installation guide. I hopefully lists all dependencies.

= Prerequisites =

 * mysql
 * python 2.5
 * python-mysqldb 
 * PIL (python imaging library) for some image stuff 

= Libraries and packages =
 * django 1.1.1 (see http://www.djangoproject.com/download/)
 
 * boto (for Mechanical Turk integration)
{{{
wget http://boto.googlecode.com/files/boto-1.8d.tar.gz
tar xvzf boto-1.8d.tar.gz
cd boto-1.8d
sudo python setup.py install
}}}

 * django-tagging  (v.0.3.0 for django 1.0.2)
{{{
wget http://django-tagging.googlecode.com/files/django-tagging-0.3.tar.gz
tar xvzf django-tagging-0.3.tar.gz
cd django-tagging-0.3
sudo python setup.py install
}}}

 * django-registration
{{{
wget http://bitbucket.org/ubernostrum/django-registration/get/v0.7.tar.gz
tar xvzf v0.7.tar.gz
cd django-registration
sudo python setup.py install
}}}


= Data locations = 

Create these folders:

 * {{{/var/datasets/}}} - images will be stored in {{{/var/datasets/<session_name>/}}} (can have internal folder structure) 
 * {{{/var/datasets/tasks/}}}  - task definitions. (xml files for the annotation interface)
 * {{{/var/datasets/segmentations/}}}  - compressed segmentations storage. The bitmaps are compressed with zlib and encoded into plain text (each byte goes to two chars: 4 bits are encoded with A-P, A=0, P=15).



= Details =

 * check out the code (web_annotations_server)
   * Put the code in /var/django
   * Create /var/datasets

 * create user and database for django. Write them to settings.py. Grant all permissions to the created user on the specified database. 

 * Install django-registration
   * Install python-setuptools
   * Run easy_install django-registration
 * Install a local smtp server (to e-mail things from python)
 * Enable appropriate applications (mturk contains some templates used by other apps).
 * Run syncdb: {{{python manage.py syncdb}}}

 * Download the required javascripts into web_annotations_server/mturk/code/js/:
   * [http://vm7.willowgarage.com/code/all_js.tgz all_js.tgz]

 * Look into settings.py and set DJ_CODE_RT, DATASETS_ROOT

 * [optional] Run development server: {{{python manage.py runserver <host>:8080}}}

== Installing into Apache ==

This is probably wrong, but it does what I want. A better way to do it is to have a single virtual site for django.

 * Install mod-python (apt-get install libapache2-mod-python)
 * Put django.conf into /etc/apache2/conf.d/.
   * Edit it: change python paths; Correct the alias for /media. 
   * Enable/disable other configs
 * Include django.conf into /etc/apache2/sites-enabled/000-default
{{{
Include /etc/apache2/conf.d/django.conf
}}}
 * sudo apache2ctl restart