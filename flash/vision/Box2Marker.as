/********************************************************************** Software License Agreement (BSD License)**  Copyright (c) 2008, University of Illinois at Urbana-Champaign*  All rights reserved.**  Redistribution and use in source and binary forms, with or without*  modification, are permitted provided that the following conditions*  are met:**   * Redistributions of source code must retain the above copyright*     notice, this list of conditions and the following disclaimer.*   * Redistributions in binary form must reproduce the above*     copyright notice, this list of conditions and the following*     disclaimer in the documentation and/or other materials provided*     with the distribution.*   * Neither the name of the University of Illinois nor the names of its*     contributors may be used to endorse or promote products derived*     from this software without specific prior written permission.**  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS*  "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT*  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS*  FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE*  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,*  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,*  BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;*  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER*  CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT*  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN*  ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE*  POSSIBILITY OF SUCH DAMAGE.*********************************************************************//***** Author: Alexander Sorokin, Department of Computer Science,*                                  University of Illinois at Urbana-Champaign.* Advised by: David Forsyth.*****/package vision{			import flash.display.*;	import vision.ResizeMarker;		//import flash.display.Shape;	//import fl.controls.Label;	//import flash.events.MouseEvent;	import flash.events.Event;	import flash.events.FocusEvent;	import fl.managers.*;	import flash.text.*;	//import flash.geom.Point;	//import vision.Box2Marker;	//import flash.text.*;	 	 dynamic public class Box2Marker extends MovieClip 	 {		 		 public var t0:Number;		 public var t1:Number;		 public var creation_time:Number;		 public var last_modification_time:Number;  		 public var detail_input_specs;		 public var resize_markers:Array;		 var tag:TextField;		 		 var x0,x1,y0,y1;		 var m1,m2,m3,m4:vision.ResizeMarker;		 function Box2Marker()		 {			var now:Date = new Date();			creation_time=now.getTime();			last_modification_time=now.getTime();			t0=now.getTime();			t1=now.getTime();			detail_input_specs=null;			tag=null;			this.addEventListener(Event.RESIZE,on_resize);			//this.addEventListener(FocusEvent.FOCUS_IN, on_focus_in);			//this.addEventListener(FocusEvent.FOCUS_OUT, on_focus_out);		 }		 public function set_color(newC:int):void{		 			 }		 public function set_lbl(txt:String):void{			if(tag==null){				tag=new TextField();								tag.background=false;				tag.autoSize=TextFieldAutoSize.LEFT;								tag.textColor=0xFFFFFF;				tag.text=txt;				//tag.width=Math.min(tag.width,this.width)				//tag.height=Math.min(tag.height,this.height)				tag.x=this.x;//+bW/2-tag.width/2;				tag.y=this.y;//bY+bH/2-tag.height/2;				this.parent.addChild(tag);			}else{				tag.text=txt;				//tag.width=Math.min(tag.width,this.width)				//tag.height=Math.min(tag.height,this.height)				tag.x=this.x;//+bW/2-tag.width/2;				tag.y=this.y;//bY+bH/2-tag.height/2;			}			//this.addChild(tag);		 }		 public function highlight_invalid():void{		 	gotoAndStop(3);		 }		 public function get_xml():String{			 return ""		 }		 var rootObj;		 public function set_root(newRootObj):void{			 this.rootObj=newRootObj;		 }		 		 public function setEditMode():void{			 resize_markers=new Array();			 			 this.x0=x;			 this.y0=y;			 this.x1=x+width-1;			 this.y1=y+height-1;			 			 m1=new vision.ResizeMarker();			 m1.x=x0;			 m1.y=y0;			 //m1.addEventListener("my_resize_marker_move", on_resize_marker_move);			 m1.idx=1;			 m1.parent_box=this;			 // this.parent.parent.addChild(this.parent); //move it to the top			 this.parent.addChild(m1);			 //rootObj.the_sites_holder.addChild(m1);			 			 m2=new vision.ResizeMarker();			 m2.x=x1;			 m2.y=y0;			 m2.addEventListener("my_resize_marker_move", on_resize_marker_move);			 m2.idx=2;			 //rootObj.the_sites_holder.addChild(m2);			 this.parent.addChild(m2);			 m3=new vision.ResizeMarker();			 m3.x=x0;			 m3.y=y1;			 m3.addEventListener("my_resize_marker_move", on_resize_marker_move);			 m3.idx=3;			 //rootObj.the_sites_holder.addChild(m3);			 this.parent.addChild(m3);			 m4=new vision.ResizeMarker();			 m4.x=x1;			 m4.y=y1;			 m4.addEventListener("my_resize_marker_move", on_resize_marker_move);			 m4.idx=4;			 //rootObj.the_sites_holder.addChild(m4);			 this.parent.addChild(m4);			 			 var start_edit_event:Event = new Event("my_start_edit_mode");			 this.dispatchEvent(start_edit_event);			}			 			public function removeEditMode():void{				this.parent.removeChild(m1);				this.parent.removeChild(m2);				this.parent.removeChild(m3);				this.parent.removeChild(m4);								var finish_edit_event:Event = new Event("my_finish_edit_mode");				this.dispatchEvent(finish_edit_event);			}			public function on_resize_marker_move(event:Event):void			{				var m=vision.ResizeMarker(event.target);								do_resize_on_marker(m);			}			public function do_resize_on_marker(m:vision.ResizeMarker):void			{				if(m.idx==1){ //upper_left					this.x0=m.x;					this.y0=m.y;				}							if(m.idx==2){ //upper_right					this.x1=m.x;					this.y0=m.y;				}							if(m.idx==3){ //lower_left					this.x0=m.x;					this.y1=m.y;				}							if(m.idx==4){ //lower_right					this.x1=m.x;					this.y1=m.y;				}							this.x=x0;				this.y=y0;				this.width=x1-x0+1;				this.height=y1-y0+1;								m1.x=x0;				m1.y=y0;				m2.x=x1;				m2.y=y0;				m3.x=x0;				m3.y=y1;				m4.x=x1;				m4.y=y1;				if(tag!=null){					tag.x=this.x;//+bW/2-tag.width/2;					tag.y=this.y;				}						}					public function on_resize(event:Event):void			{				if(tag!=null){					tag.x=this.x;//+bW/2-tag.width/2;					tag.y=this.y;				}			}	 }}